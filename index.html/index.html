<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Capacita SM - Acceso</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
html, body {
    margin: 0; padding: 0; width: 100%; height: 100%; font-family: Arial, sans-serif;
    background: url('fondo.png') no-repeat center center fixed; background-size: cover;
}
@media (max-width: 768px) { body { background-attachment: scroll; } }
#menuPrincipal, .seccion {
    background: rgba(255,255,255,0.95); padding: 20px; border-radius: 10px;
    margin: 20px auto; max-width: 300px; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    text-align: center;
}
#menuPrincipal button, .boton-volver {
    width: 100%; margin: 10px 0; padding: 12px; font-size: 16px;
    background: #4C7C46; color: white; border: none; border-radius: 6px; cursor: pointer;
}
#menuPrincipal button:hover, .boton-volver:hover { background: #3B6138; }
.curso-tile {  background: #A3C95A;padding: 15px;text-align: center;border-radius: 6px;cursor: pointer;font-weight: bold;transition: transform 0.2s;}
.curso-tile:hover {background: #4C7C46;color: white;transform: scale(1.05);}
#panelEmpresa { display: none; height: 100vh; width: 100%; }
#menuLateral {
    width: 250px; background: rgba(255,255,255,0.95); padding: 20px;
    box-shadow: 2px 0 5px rgba(0,0,0,0.3); display: flex; flex-direction: column;
}
#contenidoEmpresa { flex-grow: 1; padding: 30px; background: rgba(255,255,255,0.9); margin: 20px; border-radius: 10px; overflow-y: auto; }
table { width: 100%; border-collapse: collapse; }
table th, table td { padding: 8px; text-align: left; border: 1px solid #ddd; }
table td input { width: 100%; border: none; background: transparent; }
</style>
</head>
<body>
<section id="menuPrincipal">
    <h2>ACCESO</h2>
    <button onclick="mostrarTrabajador()">Trabajadores</button>
    <button onclick="mostrarLoginEmpresa()">Empresas</button>
</section>
<section id="seccionTrabajador" class="seccion" style="display:none">
    <h2>Ingrese su RUT</h2>
    <input type="text" id="rutAcceso" placeholder="RUT">
    <button onclick="accederTrabajador()">Entrar</button>
    <button class="boton-volver" onclick="volverMenu()">Volver</button>
</section>
   <section id="mosaicoCursos" class="seccion" style="display:none; max-width: 100%; background: transparent; box-shadow: none;">
    <h2 style="background: rgba(255,255,255,0.95); padding: 15px; border-radius: 10px; display: inline-block;">Cursos Disponibles</h2>
    
    <div id="gridCursos" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 20px;">
        
        <div class="curso-tile" onclick="verCurso('Uso y Manejo de Extintores')">Uso y Manejo de Extintores</div>
        <div class="curso-tile" onclick="verCurso('EPP - Uso y Mantención')">EPP - Uso y Mantención</div>
        <div class="curso-tile" onclick="verCurso('Procedimientos de Trabajo Seguro')">Procedimientos de Trabajo Seguro</div>
        <div class="curso-tile" onclick="verCurso('Manejo Seguro de Herramientas')">Manejo Seguro de Herramientas</div>
        <div class="curso-tile" onclick="verCurso('Manejo Seguro de Material Cortopunzante')">Manejo Seguro de Material Cortopunzante</div>
        <div class="curso-tile" onclick="verCurso('Prevención de Riesgos Eléctricos')">Prevención de Riesgos Eléctricos</div>
        <div class="curso-tile" onclick="verCurso('Manejo Manual de Cargas')">Manejo Manual de Cargas</div>
        <div class="curso-tile" onclick="verCurso('Prácticas Seguras en Labores de Aseo')">Prácticas Seguras en Labores de Aseo</div>
        <div class="curso-tile" onclick="verCurso('Manipulación Higiénica de Alimentos')">Manipulación Higiénica de Alimentos</div>
        <div class="curso-tile" onclick="verCurso('Seguridad en Máquinas Panadería')">Seguridad en Máquinas Panadería</div>
        <div class="curso-tile" onclick="verCurso('Comportamientos Seguros en Cocinas y Restaurant')">Comportamientos Seguros en Cocinas y Restaurant</div>
        <div class="curso-tile" onclick="verCurso('Trayecto Seguro')">Trayecto Seguro</div>
        <div class="curso-tile" onclick="verCurso('Prevención y Respuesta a Incendios')">Prevención y Respuesta a Incendios</div>
        <div class="curso-tile" onclick="verCurso('Seguridad Frente a Incendios')">Seguridad Frente a Incendios</div>
        <div class="curso-tile" onclick="verCurso('Gestión de Riesgos de Desastres')">Gestión de Riesgos de Desastres</div>
        <div class="curso-tile" onclick="verCurso('Protocolo PREXOR - Exposición a Ruido')">Protocolo PREXOR - Exposición a Ruido</div>
        <div class="curso-tile" onclick="verCurso('Manejo Post Exposición a Sangre')">Manejo Post Exposición a Sangre</div>
        <div class="curso-tile" onclick="verCurso('Prevención Acoso Laboral y Sexual')">Prevención Acoso Laboral y Sexual</div>
        <div class="curso-tile" onclick="verCurso('Violencia y Acoso en el Trabajo')">Violencia y Acoso en el Trabajo</div>
        <div class="curso-tile" onclick="verCurso('Primeros Auxilios Psicológicos')">Primeros Auxilios Psicológicos</div>
        <div class="curso-tile" onclick="verCurso('Seguridad en Asaltos - Comercio')">Seguridad en Asaltos - Comercio</div>
        <div class="curso-tile" onclick="verCurso('Seguridad para Reponedores Fiambrerías')">Seguridad para Reponedores Fiambrerías</div>
    
    <button class="boton-volver" onclick="volverTrabajador()">Volver</button>
</section>

<section id="moduloCurso" class="seccion" style="display:none">
    <h2 id="tituloCurso">Módulo</h2>
    <p>Los extintores deben estar visibles. <input type="text" id="p1"></p>
    <p>Los extintores no requieren mantención. <input type="text" id="p2"></p>
    <p>Se debe apuntar a la base del fuego. <input type="text" id="p3"></p>
    <button onclick="finalizarModulo()">Finalizar Módulo</button>
    <button class="boton-volver" onclick="volverCursos()">Volver</button>
</section>
<section id="evaluacionFinal" class="seccion" style="display:none">
    <h2>Evaluación Final</h2>
    <div id="preguntasFinal"></div>
    <button onclick="finalizarEvaluacion()">Enviar Evaluación</button>
    <p id="resultadoFinal"></p>
    <button class="boton-volver" onclick="volverModulo()">Volver</button>
</section>
<section id="loginEmpresa" class="seccion" style="display:none">
    <h2>Acceso Empresas</h2>
    <input type="text" id="usuarioEmpresa" placeholder="Usuario">
    <input type="password" id="claveEmpresa" placeholder="Contraseña">
    <button onclick="accederEmpresa()">Entrar</button>
    <button class="boton-volver" onclick="volverMenu()">Volver</button>
</section>
<div id="panelEmpresa">
    <div id="menuLateral">
        <h3>Empresa XYZ</h3>
        <p>RUT: 12.345.678-9</p>
        <button onclick="mostrarSeccionEmpresa()">Gestión de Trabajadores</button>
        <button onclick="exportarTrabajadores()">Exportar</button>
        <button onclick="document.getElementById('importador').click()">Importar</button>
        <input type="file" id="importador" accept=".csv,.xlsx" style="display:none" onchange="importarTrabajadores(this)">
        <button onclick="volverMenu()">Cerrar Sesión</button>
    </div>
    <div id="contenidoEmpresa">
        <h2>Listado de Trabajadores</h2>
        <input type="text" id="nombre"><input type="text" id="rut"><input type="text" id="cargo">
        <input type="text" id="centro"><input type="date" id="fechaIngreso">
        <button onclick="registrarTrabajador()">Agregar</button>
        <table><thead><tr><th>RUT</th><th>Nombre</th><th>Cargo</th><th>Centro</th><th>Fecha</th><th>Eliminar</th></tr></thead>
        <tbody id="tablaTrabajadores"></tbody></table>
    </div>
</div>
<script>
const usuarioValido = "empresa", claveValida = "1234";
let trabajadores = JSON.parse(localStorage.getItem("trabajadores")) || [];
function ocultarTodo(){document.querySelectorAll(".seccion").forEach(s=>s.style.display="none"); document.getElementById('menuPrincipal').style.display="none"; document.getElementById('panelEmpresa').style.display="none";}
function volverMenu(){ocultarTodo();document.getElementById('menuPrincipal').style.display='block';}
function mostrarTrabajador(){ocultarTodo();document.getElementById('seccionTrabajador').style.display='block';}
function mostrarLoginEmpresa(){ocultarTodo();document.getElementById('loginEmpresa').style.display='block';}
function accederTrabajador(){const r=document.getElementById('rutAcceso').value.trim();if(trabajadores.find(t=>t.rut===r)){ocultarTodo();document.getElementById('mosaicoCursos').style.display='block';}else{alert("RUT no registrado");}}
function volverTrabajador(){mostrarTrabajador();}
function verCurso(nombre) { ocultarTodo();document.getElementById('moduloCurso').style.display = 'block';document.getElementById('tituloCurso').textContent = nombre;}
function volverCursos(){document.getElementById('mosaicoCursos').style.display='block';}
function volverModulo(){document.getElementById('moduloCurso').style.display='block';}
function finalizarModulo(){const p1=document.getElementById('p1').value.trim().toLowerCase(),p2=document.getElementById('p2').value.trim().toLowerCase(),p3=document.getElementById('p3').value.trim().toLowerCase();if(p1=="verdadero"&&p2=="falso"&&p3=="verdadero"){ocultarTodo();document.getElementById('evaluacionFinal').style.display='block';cargarEvaluacionFinal();}else{alert("Respuestas incorrectas");}}
function cargarEvaluacionFinal(){const c=document.getElementById('preguntasFinal');c.innerHTML="";[["¿Extintores visibles?","si"],["¿No necesitan mantención?","no"],["¿Apuntar a base del fuego?","si"]].forEach((p,i)=>{c.innerHTML+=`${p[0]}<br><input id='final${i}'><br>`;});}
function finalizarEvaluacion(){let c=0;[["¿Extintores visibles?","si"],["¿No necesitan mantención?","no"],["¿Apuntar a base del fuego?","si"]].forEach((p,i)=>{if(document.getElementById(`final${i}`).value.trim().toLowerCase()===p[1])c++;});document.getElementById('resultadoFinal').textContent=c>=3?"¡Aprobado!":"Debe repetir";}
function accederEmpresa(){if(document.getElementById('usuarioEmpresa').value.trim()===usuarioValido&&document.getElementById('claveEmpresa').value.trim()===claveValida){ocultarTodo();document.getElementById('panelEmpresa').style.display='flex';actualizarTabla();}else{alert("Credenciales incorrectas");}}
function mostrarSeccionEmpresa(){actualizarTabla();}
function registrarTrabajador(){const n=document.getElementById('nombre').value.trim(),r=document.getElementById('rut').value.trim(),c=document.getElementById('cargo').value.trim(),ce=document.getElementById('centro').value.trim(),f=document.getElementById('fechaIngreso').value;if(n&&r&&c&&ce&&f){trabajadores.push({nombre:n,rut:r,cargo:c,centro:ce,fechaIngreso:f});localStorage.setItem("trabajadores",JSON.stringify(trabajadores));actualizarTabla();}else{alert("Complete todos los campos");}}
function actualizarTabla(){const t=document.getElementById('tablaTrabajadores');t.innerHTML="";trabajadores.forEach((tr,i)=>{t.innerHTML+=`<tr><td>${tr.rut}</td><td>${tr.nombre}</td><td>${tr.cargo}</td><td>${tr.centro}</td><td>${tr.fechaIngreso}</td><td><button onclick='eliminarTrabajador(${i})'>Eliminar</button></td></tr>`;});}
function eliminarTrabajador(i){if(confirm("Eliminar trabajador?")){trabajadores.splice(i,1);localStorage.setItem("trabajadores",JSON.stringify(trabajadores));actualizarTabla();}}
function exportarTrabajadores(){let c="RUT,Nombre,Cargo,Centro,Fecha Ingreso\n";trabajadores.forEach(t=>{c+=`${t.rut},${t.nombre},${t.cargo},${t.centro},${t.fechaIngreso}\n`;});const b=new Blob([c],{type:'text/csv'}),l=document.createElement("a");l.href=URL.createObjectURL(b);l.download="trabajadores.csv";l.click();}
function importarTrabajadores(inp){const f=inp.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{if(f.name.endsWith(".csv")){e.target.result.split('\n').forEach(l=>{const[d1,d2,d3,d4,d5]=l.split(',');if(d1&&d2&&d3&&d4&&d5)trabajadores.push({rut:d1,nombre:d2,cargo:d3,centro:d4,fechaIngreso:d5});});}else{const wb=XLSX.read(e.target.result,{type:'binary'});XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]).forEach(d=>{if(d.RUT&&d.Nombre)trabajadores.push({rut:d.RUT,nombre:d.Nombre,cargo:d.Cargo,centro:d.Centro,fechaIngreso:d['Fecha Ingreso']});});}localStorage.setItem("trabajadores",JSON.stringify(trabajadores));actualizarTabla();};if(f.name.endsWith(".xlsx"))r.readAsBinaryString(f);else r.readAsText(f);inp.value="";}
</script>
</body>
</html>


</body>
</html>


