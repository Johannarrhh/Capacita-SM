<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CURSOS</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #27AE60;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    h2, h3 {
      text-align: center;
      color: #333333;
    }
    form {
      display: flex;
      flex-direction: column;
    }
    label {
      margin-top: 10px;
      font-weight: bold;
    }
    input, select, textarea {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      background-color: #333333;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #27AE60;
    }
    .hidden {
      display: none;
    }
    hr {
      margin: 10px 0;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div style="text-align: center;">
    <img src="Capacita SM.png" alt="Capacita SM" style="max-width: 120px; margin-bottom: 10px;">
  </div>
  <h2>CURSOS</h2>
  <form id="formularioCertificado">
    <label for="nombre">Nombre del Participante:</label>
    <input type="text" id="nombre" required>

    <label for="curso">Seleccione un Curso:</label>
    <select id="curso" required></select>

    <div id="preguntaContainer" class="hidden"></div>

    <button type="submit">Generar Certificado</button>
  </form>

  <script>
    const cursos = [
      {
        codigo: "C001",
        nombre: "Prevención de Riesgos Laborales",
        preguntas: Array.from({ length: 20 }, (_, i) => {
          return {
            texto: `Pregunta ${i + 1}: ¿Cuál es la respuesta correcta?`,
            opciones: ["Opción A", "Opción B", "Opción C"],
            respuestaCorrecta: "Opción A"
          };
        })
      }
    ];

    const selectCurso = document.getElementById("curso");
    const preguntaContainer = document.getElementById("preguntaContainer");

    cursos.forEach(curso => {
      const opt = document.createElement("option");
      opt.value = curso.codigo;
      opt.textContent = `${curso.nombre}`;
      selectCurso.appendChild(opt);
    });

    selectCurso.addEventListener("change", () => {
      const curso = cursos.find(c => c.codigo === selectCurso.value);
      preguntaContainer.innerHTML = "";
      preguntaContainer.classList.remove("hidden");

      curso.preguntas.forEach((pregunta, index) => {
        const bloque = document.createElement("div");
        bloque.innerHTML = `
          <label><strong>${index + 1}. ${pregunta.texto}</strong></label>
          ${pregunta.opciones.map((op, i) =>
            `<div><input type="radio" name="pregunta${index}" value="${op}" required> ${op}</div>`
          ).join("")}
          <hr/>
        `;
        preguntaContainer.appendChild(bloque);
      });
    });

    document.getElementById("formularioCertificado").addEventListener("submit", function(e) {
      e.preventDefault();
      const nombre = document.getElementById("nombre").value.trim();
      const curso = cursos.find(c => c.codigo === selectCurso.value);

      let respuestasCorrectas = 0;
      curso.preguntas.forEach((pregunta, index) => {
        const seleccionada = document.querySelector(`input[name="pregunta${index}"]:checked`);
        if (seleccionada && seleccionada.value === pregunta.respuestaCorrecta) {
          respuestasCorrectas++;
        }
      });

      if (respuestasCorrectas < curso.preguntas.length) {
        alert(`❌ Solo respondiste correctamente ${respuestasCorrectas} de ${curso.preguntas.length}. No se puede generar el certificado.`);
        return;
      }

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(22);
      doc.text("Certificado de Participación", 20, 30);
      doc.setFontSize(16);
      doc.text(`Se certifica que ${nombre}`, 20, 50);
      doc.text(`ha completado satisfactoriamente el curso:`, 20, 60);
      doc.text(`\"${curso.nombre}\"`, 20, 70);
      doc.text("Fecha: " + new Date().toLocaleDateString(), 20, 90);

      doc.save(`${nombre.replace(/\s+/g, '_')}_${curso.codigo}_certificado.pdf`);
    });
  </script>
</body>
</html>


